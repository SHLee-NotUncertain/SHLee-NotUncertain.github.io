{% assign categories_max = 0 %}
{% for category in site.categories %}
  {% if category[1].size > categories_max %}
    {% assign categories_max = category[1].size %}
  {% endif %}
{% endfor %}

<nav class="nav__list">
  <input id="ac-toc" name="accordion-toc" type="checkbox" />
  <label for="ac-toc">{{ site.data.ui-text[site.locale].menu_label | default: "Toggle Menu" }}</label>
  <ul class="nav__items">
    <li>
      <span class="nav__sub-title">ğŸ“‚ ì „ì²´ ê²Œì‹œê¸€ ({{ site.posts.size }})</span>
      <ul>
        <li><a href="/posts/">ëª¨ë“  ê²Œì‹œê¸€ ë³´ê¸°</a></li>
      </ul>
    </li>

    {% assign sorted_categories = site.categories | sort %}
    <ul class="category-accordion">
      {% for category in sorted_categories %}
        <li>
          <details>
            <summary class="nav__sub-title">{{ category[0] }} ({{ category[1].size }})</summary>

            <a href="{{ site.baseurl }}/categories/#{{ category[0] | slugify }}" class="category-link">ì „ì²´ ë³´ê¸°</a>

            {% comment %}<!-- ì´ ì¹´í…Œê³ ë¦¬ì˜ íƒœê·¸ë“¤ ìˆ˜ì§‘ -->{% endcomment %}
            {% assign category_tags = "" | split: "" %}
            {% for post in category[1] %}
              {% for tag in post.tags %}
                {% unless category_tags contains tag %}
                  {% assign category_tags = category_tags | push: tag %}
                {% endunless %}
              {% endfor %}
            {% endfor %}

            {% comment %}<!-- íƒœê·¸ë³„ ê²Œì‹œê¸€ ê°œìˆ˜ ê³„ì‚° ë° í‘œì‹œ -->{% endcomment %}
            {% assign sorted_tags = category_tags | sort %}
            {% if sorted_tags.size > 0 %}
              <ul class="tag-list">
                {% for tag in sorted_tags %}
                  {% assign tag_count = 0 %}
                  {% for post in category[1] %}
                    {% if post.tags contains tag %}
                      {% assign tag_count = tag_count | plus: 1 %}
                    {% endif %}
                  {% endfor %}
                  <li>
                    <a href="{{ site.baseurl }}/tags/#{{ tag | slugify }}">
                      ğŸ·ï¸ {{ tag }} ({{ tag_count }})
                    </a>
                  </li>
                {% endfor %}
              </ul>
            {% endif %}
          </details>
        </li>
      {% endfor %}
    </ul>
  </ul>
</nav>
